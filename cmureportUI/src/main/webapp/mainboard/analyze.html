<html ng-app="BugsPerMonthChart">
<head>
    <title>Bugs Per Month</title>
</head>
<body>
<div ng-view>
</div>
<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.0.3/angular.js"></script>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js" type="text/javascript"></script>
<script src="http://code.highcharts.com/highcharts.js"></script>
<script src="/js/analyze.js"></script>
<script>
    function ProjectBugsCtrl($scope, $http){

        var params = getQueryParams(location.search);

        var query_data = {
            projectKey:params.projectKey,
            oauthVerifier: params.oauth_verifier
        };

        var config = {
            params: query_data,
            headers : {'Accept' : 'application/json'}
        };

        function getQueryParams(qs) {
            qs = qs.split('+').join(' ');

            var params = {},
                    tokens,
                    re = /[?&]?([^=]+)=([^&]*)/g;

            while (tokens = re.exec(qs)) {
                params[decodeURIComponent(tokens[1])] = decodeURIComponent(tokens[2]);
            }

            return params;
        }

        $http.get('/jreport/issues/', config).then(function(response) {
            var data = {
                "xData": response.data.xdata,
                "yData": response.data.ydata

            };
            $scope.lineChartYData=data.yData;
            $scope.lineChartXData=data.xData
        }, function(response) {

        });

    }
</script>
<script>
    angular.module('BugsPerMonthChart',['AngularChart'], function( $routeProvider, $locationProvider ){
        $routeProvider.when('/',{
            template: '<chart title="Project Bugs" xData="lineChartXData" yData="lineChartYData" xName="Month" yName="Hit" subtitle="Compare your projects" style="width:50%; float:left"></chart>',
            controller: ProjectBugsCtrl
        })
    })

</script>

<div ng-controller="DevBugsCtrl">
    <chart title="Project Bugs" xData="lineChartXData" yData="lineChartYData" xName="Month" yName="Hit" subtitle="Compare your projects" style="width:50%; float:left"></chart>
</div>
<script>
    function DevBugsCtrl($scope, $http){
        var params = getQueryParams(location.search);

        var query_data = {
            projectKey:params.projectKey,
            oauthVerifier: params.oauth_verifier
        };

        var config = {
            params: query_data,
            headers : {'Accept' : 'application/json'}
        };

        function getQueryParams(qs) {
            qs = qs.split('+').join(' ');

            var params = {},
                    tokens,
                    re = /[?&]?([^=]+)=([^&]*)/g;

            while (tokens = re.exec(qs)) {
                params[decodeURIComponent(tokens[1])] = decodeURIComponent(tokens[2]);
            }

            return params;
        }

        $http.get('/jreport/devbugs/', config).then(function(response) {
            var data = {
                "xData": response.data.xdata,
                "yData": response.data.ydata

            };
            $scope.lineChartYData=data.yData;
            $scope.lineChartXData=data.xData
        }, function(response) {

        });

        $scope.lineChartYData=data.yData
        $scope.lineChartXData=data.xData
    }
</script>

<div ng-controller="TestCtr1">
    <chart title="Project Bugs" xData="lineChartXData" yData="lineChartYData" xName="Month" yName="Hit" subtitle="Compare your projects" style="width:50%; float:left"></chart>
</div>
<script>
    function TestCtr1($scope, $http){
        var data = {
            "xData": ["Jan", "Feb", "Mar", "Apr", "May", "Jun","Jul", "Aug", "Sep", "Oct", "Nov", "Dec"],
            "yData":[{
                "name": "TEST",
                "data": [7.0, 6.9, 9.5, 14.5, '', 21.5, 25.2, 26.5, 23.3, 18.3, 13.9, '']
            },
                {"name": "TEST-2",
                    "data": [10.0, 3.4, 8, 23, 4, 5, 6, 4 , 6 , '' , 10]
                }
            ]
        }

        $scope.lineChartYData=data.yData
        $scope.lineChartXData=data.xData
    }
</script>

<div ng-controller="TestCtr2">
    <chart title="Project Bugs" xData="lineChartXData" yData="lineChartYData" xName="Month" yName="Hit" subtitle="Compare your projects" style="width:50%; float:left"></chart>
</div>
<script>
    function TestCtr2($scope, $http){
        var data = {
            "xData": ["Jan", "Feb", "Mar", "Apr", "May", "Jun","Jul", "Aug", "Sep", "Oct", "Nov", "Dec"],
            "yData":[{
                "name": "TEST",
                "data": [7.0, 6.9, 9.5, 14.5, '', 21.5, 25.2, 26.5, 23.3, 18.3, 13.9, '']
            },
                {"name": "TEST-2",
                    "data": [10.0, 3.4, 8, 23, 4, 5, 6, 4 , 6 , '' , 10]
                }
            ]
        }

        $scope.lineChartYData=data.yData
        $scope.lineChartXData=data.xData
    }
</script>

</body>
</html>